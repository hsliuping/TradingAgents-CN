# 阶段六：前端适配与交互优化 - 总体规划

## 1. 背景与目标

当前后端已完成“指数分析 workflow”的核心功能（包括宏观、政策、行业、技术分析、多空博弈、风险裁判等），但前端界面（`SingleAnalysis.vue`）仍停留在“单股分析”阶段，缺少对新 Agent 的选择支持、指数代码的输入适配以及深度分析结果的展示。

本阶段的目标是**打通前端与后端的指数分析能力**，使用户能够通过 Web 界面完整体验 v2.0-v2.4 开发的所有指数分析功能。

## 2. 核心任务分解

> 详细实施文档已拆分为：
> - [01-基础与类型适配](./01-基础与类型适配.md)
> - [02-交互逻辑与发起页](./02-交互逻辑与发起页.md)
> - [03-结果展示与组件开发](./03-结果展示与组件开发.md)

### 2.1 基础配置与类型定义 (Foundation)
- [ ] **更新分析师常量** (`frontend/src/constants/analysts.ts`)：
    - 新增 Macro Analyst (宏观)
    - 新增 Policy Analyst (政策)
    - 新增 Sector Analyst (行业)
    - 新增 Technical Analyst (技术 - 独立节点)
    - 新增 International News Analyst (国际新闻)
    - 新增 Bull/Bear Researcher (多空博弈)
    - 新增 Risk Judge (风险裁判)
- [ ] **更新 API 类型** (`frontend/src/api/analysis.ts`)：
    - 确保 `SingleAnalysisRequest` 支持传递完整的 `selected_analysts` 列表。
    - 扩展 `AnalysisResult` 类型，增加指数分析特有的报告字段（如 `macro_report`, `debate_summary` 等）。

### 2.2 分析发起页改造 (Analysis Initiation)
- [ ] **模式切换支持**：
    - 在 `SingleAnalysis.vue` 中增加“分析模式”切换（个股分析 vs 指数分析）。
    - 指数分析模式下，预设/校验指数代码（如 `000001.SH`, `399001.SZ`）。
- [ ] **动态 Agent 选择器**：
    - 根据选择的模式（个股/指数），动态展示可用的分析师列表。
    - 指数模式下，默认选中 Macro、Policy、Technical 等核心节点。
- [ ] **深度选择逻辑适配**：
    - 调整“分析深度”选项，使其对应指数分析的不同 Agent 组合（例如：快速分析仅包含技术+宏观，深度分析包含全量+博弈）。

### 2.3 分析结果页升级 (Result Visualization)
- [ ] **结果展示组件增强**：
    - 新增/适配结果卡片，用于展示：
        - 宏观经济分析报告
        - 政策解读与行业影响
        - 多空辩论过程与结论（对话式 UI 或 对比表格）
        - 风险裁判意见
    - 优化 Markdown 渲染，确保长文本报告的可读性。

### 2.4 联调与测试 (Integration & Testing)
- [ ] 前后端接口联调。
- [ ] 完整流程测试：发起指数分析 -> 等待执行 -> 查看报告。

## 3. 时间计划

| 任务模块 | 预计工时 | 优先级 |
| :--- | :--- | :--- |
| 基础配置更新 | 2h | P0 |
| 分析发起页改造 | 6h | P0 |
| 结果页展示升级 | 8h | P1 |
| 联调与测试 | 4h | P1 |

**总计预计**: 20 工时 (约 2.5 天)

## 4. 交付物

- 更新后的前端代码 (Vue 组件 + TS 配置)
- v2.5.0 版本说明文档
- 前端操作指南（更新至 README 或 帮助文档）
