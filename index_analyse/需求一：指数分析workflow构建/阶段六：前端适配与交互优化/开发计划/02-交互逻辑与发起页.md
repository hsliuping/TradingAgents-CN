# 阶段六实施细节 - 任务二：交互逻辑与发起页

本任务关注 `SingleAnalysis.vue` 的核心交互逻辑，实现严格的模式隔离与智能的参数联动。

## 1. 模式切换与 UI 布局

### 目标
用户需明确选择当前是进行“个股分析”还是“指数分析”，界面随之响应。

### 详细步骤
1.  **添加模式选择器**:
    - 位置：表单顶部。
    - 组件：`el-radio-group` 或 `el-tabs`。
    - 选项：`个股分析 (Stock)` / `指数分析 (Index)`。
    - 绑定变量：`analysisMode` (ref).
2.  **输入框联动**:
    - 当 `analysisMode === 'stock'`：使用 `validateAStock`，提示语“请输入6位股票代码”。
    - 当 `analysisMode === 'index'`：使用 `validateIndexStock`，提示语“请输入指数代码 (e.g. 000001.SH)”。

## 2. 严格隔离的 Agent 选择逻辑

### 目标
防止用户在个股分析中误选宏观分析师，或在指数分析中误选个股基本面分析师。

### 详细步骤
1.  **计算属性 `availableAnalysts`**:
    - 依赖：`analysisMode`。
    - 逻辑：
        - `stock`: 过滤 `ANALYSTS` 中 `category` 为 `stock` 或 `common` 的项。
        - `index`: 过滤 `ANALYSTS` 中 `category` 为 `index` 或 `common` 的项。
2.  **强制刷新选择**:
    - 监听 `analysisMode` 变化。
    - 当模式切换时，清空当前 `form.selectedAnalysts`。
    - 重新填充该模式下的默认推荐 Agent 组合。

## 3. 深度参数与 Agent 联动 (Depth-Agent Mapping)

### 目标
通过“分析深度”参数快捷控制 Agent 的开启/关闭，体现“深度决定工作量”的逻辑。

### 详细步骤
1.  **定义深度策略常量**:
    ```typescript
    const DEPTH_STRATEGIES = {
      index: {
        quick: ['macro', 'technical_index'],
        standard: ['macro', 'technical_index', 'policy', 'sector'],
        deep: ['macro', 'technical_index', 'policy', 'sector', 'intl_news', 'bull_bear', 'risk']
      },
      stock: {
        // ... stock strategies
      }
    }
    ```
2.  **实现联动逻辑**:
    - 监听 `form.depth` 变化。
    - 当深度改变且用户未处于“自定义模式”时，自动更新 `form.selectedAnalysts` 为对应策略的 Agent 列表。
3.  **支持手动覆盖**:
    - 如果用户手动勾选/取消了某个 Agent，将状态标记为 `custom`，不再随深度选项自动跳变，直到用户再次手动切换深度。
