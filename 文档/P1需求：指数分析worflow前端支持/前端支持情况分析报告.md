# å‰ç«¯å¯¹æŒ‡æ•°åˆ†æåŠŸèƒ½çš„æ”¯æŒæƒ…å†µåˆ†ææŠ¥å‘Š

**åˆ†ææ—¥æœŸ**: 2025-12-14  
**åˆ†æèŒƒå›´**: å‰ç«¯ä»£ç å…¨é‡æ‰«æ  
**åç«¯åŠŸèƒ½çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æµ‹è¯•é€šè¿‡

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

### ğŸ”´ æ ¸å¿ƒç»“è®º: **å‰ç«¯å®Œå…¨ä¸æ”¯æŒæŒ‡æ•°åˆ†æåŠŸèƒ½**

åç«¯å·²å®ŒæˆæŒ‡æ•°åˆ†æåŠŸèƒ½çš„å¼€å‘å’Œæµ‹è¯•,ä½†å‰ç«¯**æ²¡æœ‰ä»»ä½•ç›¸å…³å®ç°**,ç”¨æˆ·æ— æ³•é€šè¿‡Webç•Œé¢ä½¿ç”¨è¯¥åŠŸèƒ½ã€‚

### å…³é”®é—®é¢˜

| é—®é¢˜ç±»åˆ« | ä¸¥é‡ç¨‹åº¦ | å½±å“èŒƒå›´ |
|---------|---------|---------|
| **ç¼ºå°‘ä¸“ç”¨é¡µé¢** | ğŸ”´ ä¸¥é‡ | æ— æ³•å‘èµ·æŒ‡æ•°åˆ†æ |
| **ç¼ºå°‘è·¯ç”±é…ç½®** | ğŸ”´ ä¸¥é‡ | æ— æ³•è®¿é—®æŒ‡æ•°åˆ†æåŠŸèƒ½ |
| **ç¼ºå°‘APIæ¥å£** | ğŸ”´ ä¸¥é‡ | æ— æ³•ä¸åç«¯é€šä¿¡ |
| **ç¼ºå°‘ç±»å‹å®šä¹‰** | ğŸ”´ ä¸¥é‡ | æ— æ³•å¤„ç†æŒ‡æ•°åˆ†ææ•°æ® |
| **ç¼ºå°‘èœå•å…¥å£** | ğŸ”´ ä¸¥é‡ | ç”¨æˆ·æ— æ³•å‘ç°è¯¥åŠŸèƒ½ |

---

## ğŸ” è¯¦ç»†åˆ†æ

### 1. è·¯ç”±é…ç½®åˆ†æ

#### å½“å‰çŠ¶æ€ âŒ
**æ–‡ä»¶**: `frontend/src/router/index.ts`

```typescript
// ç°æœ‰è·¯ç”±ç»“æ„
{
  path: '/analysis',
  name: 'Analysis',
  children: [
    { path: 'single', name: 'SingleAnalysis' },  // âœ… ä¸ªè‚¡åˆ†æ
    { path: 'batch', name: 'BatchAnalysis' },    // âœ… æ‰¹é‡åˆ†æ
    // âŒ ç¼ºå°‘: { path: 'index', name: 'IndexAnalysis' }
  ]
}
```

**é—®é¢˜**:
- âŒ æ²¡æœ‰ `/analysis/index` è·¯ç”±
- âŒ æ²¡æœ‰æŒ‡æ•°åˆ†æçš„è·¯ç”±é…ç½®
- âŒ æ²¡æœ‰æŒ‡æ•°åˆ†æçš„é¡µé¢ç»„ä»¶

---

### 2. é¡µé¢ç»„ä»¶åˆ†æ

#### å½“å‰é¡µé¢ç»“æ„
```
frontend/src/views/
â”œâ”€â”€ Analysis/
â”‚   â”œâ”€â”€ SingleAnalysis.vue       âœ… ä¸ªè‚¡åˆ†æé¡µé¢
â”‚   â”œâ”€â”€ BatchAnalysis.vue        âœ… æ‰¹é‡åˆ†æé¡µé¢
â”‚   â””â”€â”€ IndexAnalysis.vue        âŒ ä¸å­˜åœ¨
```

**ç¼ºå¤±ç»„ä»¶**:
1. **IndexAnalysis.vue** - æŒ‡æ•°åˆ†æä¸»é¡µé¢ âŒ
2. **IndexSelector.vue** - æŒ‡æ•°é€‰æ‹©ç»„ä»¶ âŒ
3. **IndexReportView.vue** - æŒ‡æ•°æŠ¥å‘ŠæŸ¥çœ‹ç»„ä»¶ âŒ

---

### 3. APIæ¥å£åˆ†æ

#### å½“å‰APIå®šä¹‰
**æ–‡ä»¶**: `frontend/src/api/analysis.ts`

```typescript
// âœ… å·²æœ‰æ¥å£
export interface AnalysisRequest {
  market_type: string
  stock_symbol: string       // âš ï¸ åªæ”¯æŒä¸ªè‚¡ä»£ç 
  analysis_type: string      // âš ï¸ æœªä½¿ç”¨
  // ...
}

// âŒ ç¼ºå°‘æŒ‡æ•°åˆ†ææ¥å£
export interface IndexAnalysisRequest {
  index_code: string         // æŒ‡æ•°ä»£ç 
  analysis_date: string
  // ...
}
```

**é—®é¢˜**:
- âŒ æ²¡æœ‰ `startIndexAnalysis()` æ–¹æ³•
- âŒ æ²¡æœ‰ `IndexAnalysisRequest` ç±»å‹å®šä¹‰
- âŒ æ²¡æœ‰ `IndexAnalysisResult` ç±»å‹å®šä¹‰
- âš ï¸ `analysis_type` å­—æ®µè™½ç„¶å­˜åœ¨ä½†æœªä½¿ç”¨

---

### 4. ç±»å‹å®šä¹‰åˆ†æ

#### å½“å‰ç±»å‹ç³»ç»Ÿ
**æ–‡ä»¶**: `frontend/src/types/analysis.ts`

```typescript
// âŒ ç¼ºå°‘æŒ‡æ•°åˆ†æç›¸å…³ç±»å‹
export interface AnalysisParameters {
  market_type: 'Aè‚¡' | 'ç¾è‚¡' | 'æ¸¯è‚¡'  // âš ï¸ æ— "æŒ‡æ•°"é€‰é¡¹
  // ...
}

// âŒ éœ€è¦æ–°å¢
export interface IndexAnalysisParameters {
  index_code: string
  index_name?: string
  analysis_date?: string
  // ...
}

export interface IndexAnalysisResult {
  macro_report: string
  policy_report: string
  sector_report: string
  strategy_report: string
  // ...
}
```

---

### 5. èœå•å¯¼èˆªåˆ†æ

#### å½“å‰èœå•ç»“æ„
**æ–‡ä»¶**: `frontend/src/components/Layout/SidebarMenu.vue`

```html
<el-sub-menu index="/analysis">
  <template #title>åˆ†æå·¥å…·</template>
  <el-menu-item index="/analysis/single">å•è‚¡åˆ†æ</el-menu-item>
  <el-menu-item index="/analysis/batch">æ‰¹é‡åˆ†æ</el-menu-item>
  <!-- âŒ ç¼ºå°‘: <el-menu-item index="/analysis/index">æŒ‡æ•°åˆ†æ</el-menu-item> -->
</el-sub-menu>
```

**é—®é¢˜**:
- âŒ ä¾§è¾¹æ èœå•æ²¡æœ‰"æŒ‡æ•°åˆ†æ"å…¥å£
- âŒ ä»ªè¡¨æ¿å¿«é€Ÿæ“ä½œæ²¡æœ‰"æŒ‡æ•°åˆ†æ"æŒ‰é’®
- âŒ åˆ†æå†å²é¡µé¢æ— æ³•æ˜¾ç¤ºæŒ‡æ•°åˆ†æè®°å½•

---

### 6. æ•°æ®æµåˆ†æ

#### ä¸ªè‚¡åˆ†ææµç¨‹ (ç°æœ‰) âœ…
```
ç”¨æˆ·è¾“å…¥è‚¡ç¥¨ä»£ç 
    â†“
SingleAnalysis.vue éªŒè¯ä»£ç 
    â†“
analysisApi.startSingleAnalysis()
    â†“
POST /api/analysis/single
    â†“
è½®è¯¢è·å–è¿›åº¦
    â†“
æ˜¾ç¤ºåˆ†æç»“æœ
```

#### æŒ‡æ•°åˆ†ææµç¨‹ (éœ€è¦) âŒ
```
ç”¨æˆ·é€‰æ‹©æŒ‡æ•° (ç•Œé¢ä¸å­˜åœ¨)
    â†“
IndexAnalysis.vue (ç»„ä»¶ä¸å­˜åœ¨)
    â†“
analysisApi.startIndexAnalysis() (æ¥å£ä¸å­˜åœ¨)
    â†“
POST /api/analysis/index (åç«¯å­˜åœ¨)
    â†“
è½®è¯¢è·å–è¿›åº¦ (é€»è¾‘å¯å¤ç”¨)
    â†“
æ˜¾ç¤ºæŒ‡æ•°åˆ†æç»“æœ (ç»„ä»¶ä¸å­˜åœ¨)
```

---

### 7. ä¸åç«¯çš„å·®è·åˆ†æ

#### åç«¯å·²å®ç° âœ…
| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | æ–‡ä»¶ |
|---------|------|------|10
| æŒ‡æ•°åˆ†æå›¾ | âœ… å®Œæˆ | `tradingagents/graph/setup.py` |
| å®è§‚åˆ†æå¸ˆ | âœ… å®Œæˆ | `tradingagents/agents/analysts/macro_analyst.py` |
| æ”¿ç­–åˆ†æå¸ˆ | âœ… å®Œæˆ | `tradingagents/agents/analysts/policy_analyst.py` |
| æ¿å—åˆ†æå¸ˆ | âœ… å®Œæˆ | `tradingagents/agents/analysts/sector_analyst.py` |
| ç­–ç•¥é¡¾é—® | âœ… å®Œæˆ | `tradingagents/agents/analysts/strategy_advisor.py` |
| æ•°æ®å·¥å…· | âœ… å®Œæˆ | `tradingagents/tools/index_data.py` |
| APIç«¯ç‚¹ | âœ… å®Œæˆ | `app/routers/analysis.py` |
| æµ‹è¯•éªŒè¯ | âœ… é€šè¿‡ | `tests/test_index_analysis.py` |

#### å‰ç«¯æœªå®ç° âŒ
| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | å½±å“ |
|---------|------|------|
| æŒ‡æ•°åˆ†æé¡µé¢ | âŒ ä¸å­˜åœ¨ | æ— æ³•å‘èµ·åˆ†æ |
| æŒ‡æ•°é€‰æ‹©å™¨ | âŒ ä¸å­˜åœ¨ | æ— æ³•é€‰æ‹©æŒ‡æ•° |
| APIæ¥å£ | âŒ ä¸å­˜åœ¨ | æ— æ³•è°ƒç”¨åç«¯ |
| ç±»å‹å®šä¹‰ | âŒ ä¸å­˜åœ¨ | æ— æ³•å¤„ç†æ•°æ® |
| è·¯ç”±é…ç½® | âŒ ä¸å­˜åœ¨ | æ— æ³•è®¿é—®é¡µé¢ |
| èœå•å…¥å£ | âŒ ä¸å­˜åœ¨ | ç”¨æˆ·æ— æ³•å‘ç° |
| æŠ¥å‘Šå±•ç¤º | âŒ ä¸å­˜åœ¨ | æ— æ³•æŸ¥çœ‹ç»“æœ |

---

## ğŸ¯ éœ€è¦å¼€å‘çš„åŠŸèƒ½æ¸…å•

### é«˜ä¼˜å…ˆçº§ (P0 - æ ¸å¿ƒåŠŸèƒ½)

#### 1. æŒ‡æ•°åˆ†æé¡µé¢ç»„ä»¶
**æ–‡ä»¶**: `frontend/src/views/Analysis/IndexAnalysis.vue`

**éœ€æ±‚**:
- âœ… æŒ‡æ•°é€‰æ‹©å™¨ (æ”¯æŒæœç´¢å’Œåˆ†ç±»)
- âœ… åˆ†ææ—¥æœŸé€‰æ‹©
- âœ… æ¨¡å‹é…ç½®é€‰é¡¹
- âœ… å‘èµ·åˆ†ææŒ‰é’®
- âœ… è¿›åº¦å±•ç¤º
- âœ… ç»“æœå±•ç¤º

**å‚è€ƒ**: `SingleAnalysis.vue` (çº¦850è¡Œä»£ç )

#### 2. APIæ¥å£æ‰©å±•
**æ–‡ä»¶**: `frontend/src/api/analysis.ts`

**æ–°å¢æ¥å£**:
```typescript
// æŒ‡æ•°åˆ†æè¯·æ±‚æ¥å£
export interface IndexAnalysisRequest {
  index_code: string          // å¿…éœ€: æŒ‡æ•°ä»£ç 
  parameters?: {
    analysis_date?: string    // åˆ†ææ—¥æœŸ
    quick_analysis_model?: string
    deep_analysis_model?: string
  }
}

// æŒ‡æ•°åˆ†æç»“æœæ¥å£
export interface IndexAnalysisResult {
  analysis_id: string
  index_code: string
  index_name: string
  analysis_date: string
  
  // 4ä¸ªæ ¸å¿ƒæŠ¥å‘Š
  macro_report: string
  policy_report: string
  sector_report: string
  strategy_report: string
  
  // ç­–ç•¥å»ºè®®
  market_outlook: string
  recommended_position: number
  opportunity_sectors: string[]
  key_risks: string[]
  
  // å…ƒæ•°æ®
  model_info: string
  execution_time: number
  created_at: string
}

// APIæ–¹æ³•
export const analysisApi = {
  // ... ç°æœ‰æ–¹æ³•
  
  // æ–°å¢: å¼€å§‹æŒ‡æ•°åˆ†æ
  startIndexAnalysis(request: IndexAnalysisRequest): Promise<ApiResponse<any>> {
    return request.post('/api/analysis/index', request)
  },
  
  // æ–°å¢: è·å–æŒ‡æ•°åˆ†æç»“æœ
  getIndexResult(analysisId: string): Promise<IndexAnalysisResult> {
    return request.get(`/api/analysis/index/${analysisId}/result`)
  }
}
```

#### 3. è·¯ç”±é…ç½®
**æ–‡ä»¶**: `frontend/src/router/index.ts`

**æ–°å¢è·¯ç”±**:
```typescript
{
  path: '/analysis',
  name: 'Analysis',
  children: [
    { path: 'single', ... },  // ç°æœ‰
    { path: 'batch', ... },   // ç°æœ‰
    {
      path: 'index',          // æ–°å¢
      name: 'IndexAnalysis',
      component: () => import('@/views/Analysis/IndexAnalysis.vue'),
      meta: {
        title: 'æŒ‡æ•°åˆ†æ',
        requiresAuth: true
      }
    }
  ]
}
```

#### 4. ç±»å‹å®šä¹‰æ‰©å±•
**æ–‡ä»¶**: `frontend/src/types/analysis.ts`

**æ–°å¢ç±»å‹**:
```typescript
// åˆ†æç±»å‹æšä¸¾
export enum AnalysisCategory {
  STOCK = 'stock',    // ä¸ªè‚¡åˆ†æ
  INDEX = 'index',    // æŒ‡æ•°åˆ†æ (æ–°å¢)
  BATCH = 'batch'     // æ‰¹é‡åˆ†æ
}

// æŒ‡æ•°åˆ†æå‚æ•°
export interface IndexAnalysisParameters {
  index_code: string
  index_name?: string
  analysis_date?: string
  quick_analysis_model?: string
  deep_analysis_model?: string
}

// æŒ‡æ•°æŠ¥å‘Šç»“æ„
export interface IndexReports {
  macro_report: string       // å®è§‚ç»æµåˆ†æ
  policy_report: string      // æ”¿ç­–åˆ†æ
  sector_report: string      // æ¿å—è½®åŠ¨åˆ†æ
  strategy_report: string    // ç»¼åˆç­–ç•¥å»ºè®®
}
```

---

### ä¸­ä¼˜å…ˆçº§ (P1 - ç”¨æˆ·ä½“éªŒ)

#### 5. èœå•å¯¼èˆªæ›´æ–°
**æ–‡ä»¶**: `frontend/src/components/Layout/SidebarMenu.vue`

**ä¿®æ”¹**:
```html
<el-sub-menu index="/analysis">
  <template #title>
    <el-icon><TrendCharts /></el-icon>
    <span>åˆ†æå·¥å…·</span>
  </template>
  <el-menu-item index="/analysis/single">
    <el-icon><Document /></el-icon>
    <span>å•è‚¡åˆ†æ</span>
  </el-menu-item>
  <el-menu-item index="/analysis/index">      <!-- æ–°å¢ -->
    <el-icon><Histogram /></el-icon>
    <span>æŒ‡æ•°åˆ†æ</span>
  </el-menu-item>
  <el-menu-item index="/analysis/batch">
    <el-icon><Files /></el-icon>
    <span>æ‰¹é‡åˆ†æ</span>
  </el-menu-item>
</el-sub-menu>
```

#### 6. ä»ªè¡¨æ¿å¿«é€Ÿå…¥å£
**æ–‡ä»¶**: `frontend/src/views/Dashboard/index.vue`

**æ–°å¢**:
```html
<div class="action-item" @click="goToIndexAnalysis">
  <div class="action-icon">
    <el-icon><Histogram /></el-icon>
  </div>
  <div class="action-content">
    <h3>æŒ‡æ•°åˆ†æ</h3>
    <p>åˆ†æå¸‚åœºæŒ‡æ•°ï¼ŒæŠŠæ¡æŠ•èµ„æ–¹å‘</p>
  </div>
  <el-icon class="action-arrow"><ArrowRight /></el-icon>
</div>
```

#### 7. æŒ‡æ•°é€‰æ‹©å™¨ç»„ä»¶
**æ–‡ä»¶**: `frontend/src/components/IndexSelector.vue`

**åŠŸèƒ½**:
- æŒ‡æ•°æœç´¢
- åˆ†ç±»æµè§ˆ (å®½åŸºæŒ‡æ•°/è¡Œä¸šæŒ‡æ•°/ä¸»é¢˜æŒ‡æ•°)
- å¸¸ç”¨æŒ‡æ•°å¿«é€Ÿé€‰æ‹©
- æŒ‡æ•°è¯¦æƒ…é¢„è§ˆ

**å¸¸ç”¨æŒ‡æ•°åˆ—è¡¨**:
```typescript
const COMMON_INDICES = [
  // å®½åŸºæŒ‡æ•°
  { code: 'sh000300', name: 'æ²ªæ·±300', category: 'å®½åŸº' },
  { code: 'sh000905', name: 'ä¸­è¯500', category: 'å®½åŸº' },
  { code: 'sh000852', name: 'ä¸­è¯1000', category: 'å®½åŸº' },
  { code: 'sh000688', name: 'ç§‘åˆ›50', category: 'å®½åŸº' },
  
  // è¡Œä¸šæŒ‡æ•°
  { code: 'sh931865', name: 'ä¸­è¯åŠå¯¼ä½“', category: 'è¡Œä¸š' },
  { code: 'sh000991', name: 'å…¨æŒ‡åŒ»è¯', category: 'è¡Œä¸š' },
  { code: 'sh000990', name: 'å…¨æŒ‡æ¶ˆè´¹', category: 'è¡Œä¸š' },
  
  // ä¸»é¢˜æŒ‡æ•°
  { code: 'sh931643', name: 'æ–°èƒ½æºè½¦', category: 'ä¸»é¢˜' },
  { code: 'sh931087', name: '5Gé€šä¿¡', category: 'ä¸»é¢˜' },
]
```

---

### ä½ä¼˜å…ˆçº§ (P2 - å¢å¼ºåŠŸèƒ½)

#### 8. æŠ¥å‘Šå¯¹æ¯”åŠŸèƒ½
- æ”¯æŒå¤šä¸ªæŒ‡æ•°çš„æ¨ªå‘å¯¹æ¯”
- å†å²æŠ¥å‘Šçš„çºµå‘å¯¹æ¯”
- å¯è§†åŒ–å›¾è¡¨å±•ç¤º

#### 9. æŒ‡æ•°è¡Œæƒ…é›†æˆ
- å®æ—¶æŒ‡æ•°èµ°åŠ¿å›¾
- æˆåˆ†è‚¡æ¶¨è·Œåˆ†å¸ƒ
- èµ„é‡‘æµå‘åˆ†æ

#### 10. æ™ºèƒ½æ¨è
- åŸºäºå¸‚åœºç¯å¢ƒæ¨èå…³æ³¨æŒ‡æ•°
- æ ¹æ®ç”¨æˆ·åå¥½æ¨è
- çƒ­é—¨æŒ‡æ•°æ¦œå•

---

## ğŸ“Š å·¥ä½œé‡è¯„ä¼°

### å¼€å‘å·¥ä½œé‡ (äººÂ·å¤©)

| æ¨¡å— | å·¥ä½œé‡ | ä¼˜å…ˆçº§ | ä¾èµ– |
|------|--------|--------|------|
| **IndexAnalysis.vue ä¸»é¡µé¢** | 3-4å¤© | P0 | æ—  |
| **APIæ¥å£æ‰©å±•** | 1å¤© | P0 | æ—  |
| **ç±»å‹å®šä¹‰** | 0.5å¤© | P0 | æ—  |
| **è·¯ç”±é…ç½®** | 0.5å¤© | P0 | é¡µé¢å®Œæˆ |
| **IndexSelector ç»„ä»¶** | 1-2å¤© | P1 | æ—  |
| **èœå•å¯¼èˆªæ›´æ–°** | 0.5å¤© | P1 | è·¯ç”±å®Œæˆ |
| **ä»ªè¡¨æ¿é›†æˆ** | 0.5å¤© | P1 | é¡µé¢å®Œæˆ |
| **æŠ¥å‘Šå±•ç¤ºä¼˜åŒ–** | 1-2å¤© | P1 | é¡µé¢å®Œæˆ |
| **æµ‹è¯•å’Œè°ƒè¯•** | 1-2å¤© | P0 | æ‰€æœ‰åŠŸèƒ½ |

**æ€»è®¡**: çº¦ **9-14ä¸ªå·¥ä½œæ—¥**

---

## ğŸ—ï¸ å®æ–½å»ºè®®

### é˜¶æ®µ1: æ ¸å¿ƒåŠŸèƒ½ (MVP)
**ç›®æ ‡**: ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡å‰ç«¯å‘èµ·æŒ‡æ•°åˆ†æå¹¶æŸ¥çœ‹ç»“æœ

**ä»»åŠ¡**:
1. âœ… åˆ›å»º IndexAnalysis.vue é¡µé¢
2. âœ… æ‰©å±• API æ¥å£
3. âœ… æ·»åŠ è·¯ç”±é…ç½®
4. âœ… æ›´æ–°ç±»å‹å®šä¹‰
5. âœ… åŸºç¡€æµ‹è¯•

**æ—¶é—´**: 5-7å¤©

### é˜¶æ®µ2: ç”¨æˆ·ä½“éªŒä¼˜åŒ–
**ç›®æ ‡**: æå‡æ˜“ç”¨æ€§å’Œå¯å‘ç°æ€§

**ä»»åŠ¡**:
1. âœ… åˆ›å»º IndexSelector ç»„ä»¶
2. âœ… æ›´æ–°èœå•å¯¼èˆª
3. âœ… ä»ªè¡¨æ¿é›†æˆ
4. âœ… æŠ¥å‘Šå±•ç¤ºä¼˜åŒ–

**æ—¶é—´**: 3-4å¤©

### é˜¶æ®µ3: å¢å¼ºåŠŸèƒ½
**ç›®æ ‡**: æä¾›é«˜çº§åŠŸèƒ½

**ä»»åŠ¡**:
1. â³ æŠ¥å‘Šå¯¹æ¯”
2. â³ è¡Œæƒ…é›†æˆ
3. â³ æ™ºèƒ½æ¨è

**æ—¶é—´**: å¾…å®š

---

## ğŸ”§ æŠ€æœ¯å®ç°å»ºè®®

### 1. å¤ç”¨ç°æœ‰ä»£ç 
**å¯å¤ç”¨ç»„ä»¶**:
- âœ… è¿›åº¦æ¡å±•ç¤ºé€»è¾‘ (from SingleAnalysis.vue)
- âœ… æ¨¡å‹é€‰æ‹©å™¨ (DeepModelSelector.vue)
- âœ… æŠ¥å‘ŠMarkdownæ¸²æŸ“
- âœ… ä»»åŠ¡çŠ¶æ€è½®è¯¢æœºåˆ¶

**éœ€è¦è°ƒæ•´çš„åœ°æ–¹**:
- âš ï¸ éªŒè¯é€»è¾‘: è‚¡ç¥¨ä»£ç  â†’ æŒ‡æ•°ä»£ç 
- âš ï¸ åˆ†æå¸ˆé€‰æ‹©: ä¸ªè‚¡åˆ†æå¸ˆ â†’ ä¸éœ€è¦(å›ºå®š4ä¸ªAgent)
- âš ï¸ æŠ¥å‘Šç»“æ„: 6-8ä¸ªæŠ¥å‘Š â†’ 4ä¸ªæŠ¥å‘Š

### 2. ä»£ç ç¤ºä¾‹

#### IndexAnalysis.vue æ¡†æ¶
```vue
<template>
  <div class="index-analysis">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header">
      <h1>æŒ‡æ•°åˆ†æ</h1>
      <p>AIé©±åŠ¨çš„æŒ‡æ•°åˆ†æï¼ŒæŠŠæ¡å¸‚åœºæŠ•èµ„æ–¹å‘</p>
    </div>

    <!-- åˆ†æè¡¨å• -->
    <el-form :model="form" label-width="100px">
      <!-- æŒ‡æ•°é€‰æ‹© -->
      <el-form-item label="é€‰æ‹©æŒ‡æ•°" required>
        <index-selector 
          v-model="form.indexCode" 
          @change="onIndexChange"
        />
      </el-form-item>

      <!-- åˆ†ææ—¥æœŸ -->
      <el-form-item label="åˆ†ææ—¥æœŸ">
        <el-date-picker 
          v-model="form.analysisDate"
          type="date"
          :disabled-date="disabledDate"
        />
      </el-form-item>

      <!-- æ¨¡å‹é…ç½® -->
      <el-form-item label="AIæ¨¡å‹">
        <deep-model-selector 
          v-model:quick-model="form.quickModel"
          v-model:deep-model="form.deepModel"
        />
      </el-form-item>

      <!-- æäº¤æŒ‰é’® -->
      <el-form-item>
        <el-button 
          type="primary" 
          @click="startAnalysis"
          :loading="submitting"
        >
          å¼€å§‹åˆ†æ
        </el-button>
      </el-form-item>
    </el-form>

    <!-- åˆ†æè¿›åº¦ -->
    <analysis-progress 
      v-if="analysisStatus === 'running'"
      :progress="progressInfo"
      :steps="analysisSteps"
    />

    <!-- åˆ†æç»“æœ -->
    <index-report-view 
      v-if="analysisStatus === 'completed'"
      :result="analysisResult"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import { analysisApi, type IndexAnalysisRequest } from '@/api/analysis'
import IndexSelector from '@/components/IndexSelector.vue'
import DeepModelSelector from '@/components/DeepModelSelector.vue'
import AnalysisProgress from '@/components/AnalysisProgress.vue'
import IndexReportView from '@/components/IndexReportView.vue'

const form = reactive({
  indexCode: '',
  analysisDate: new Date(),
  quickModel: 'deepseek-chat',
  deepModel: 'deepseek-reasoner'
})

const submitting = ref(false)
const analysisStatus = ref('idle')
const progressInfo = ref({})
const analysisSteps = ref([])
const analysisResult = ref(null)

const startAnalysis = async () => {
  submitting.value = true
  
  try {
    // è°ƒç”¨APIå‘èµ·åˆ†æ
    const response = await analysisApi.startIndexAnalysis({
      index_code: form.indexCode,
      parameters: {
        analysis_date: form.analysisDate.toISOString().split('T')[0],
        quick_analysis_model: form.quickModel,
        deep_analysis_model: form.deepModel
      }
    })
    
    // å¼€å§‹è½®è¯¢è¿›åº¦
    analysisStatus.value = 'running'
    pollProgress(response.data.task_id)
    
  } catch (error) {
    ElMessage.error('åˆ†æå¯åŠ¨å¤±è´¥')
  } finally {
    submitting.value = false
  }
}

const pollProgress = async (taskId: string) => {
  // å¤ç”¨SingleAnalysisçš„è½®è¯¢é€»è¾‘
  // ...
}
</script>
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ•°æ®å…¼å®¹æ€§
- âœ… åç«¯å·²æ”¯æŒ `analysis_type="index"` å‚æ•°
- âš ï¸ å‰ç«¯éœ€è¦åœ¨è¯·æ±‚ä¸­æ˜ç¡®æŒ‡å®š
- âš ï¸ ç¡®ä¿ä¸ç°æœ‰ä¸ªè‚¡åˆ†æä¸å†²çª

### 2. é”™è¯¯å¤„ç†
- âŒ æŒ‡æ•°ä»£ç éªŒè¯é€»è¾‘
- âŒ åˆ†æå¤±è´¥çš„å‹å¥½æç¤º
- âŒ ç½‘ç»œé”™è¯¯é‡è¯•æœºåˆ¶

### 3. æ€§èƒ½ä¼˜åŒ–
- â³ æŒ‡æ•°åˆ—è¡¨ç¼“å­˜
- â³ æŠ¥å‘Šæ•°æ®æ‡’åŠ è½½
- â³ å¤§å‹æŠ¥å‘Šçš„åˆ†é¡µå±•ç¤º

### 4. ç”¨æˆ·ä½“éªŒ
- â³ åŠ è½½åŠ¨ç”»
- â³ è¿›åº¦é¢„ä¼°
- â³ æŠ¥å‘Šå¯¼å‡ºåŠŸèƒ½

---

## ğŸ“ æ€»ç»“

### å½“å‰çŠ¶æ€
- âœ… **åç«¯**: å®Œå…¨å®ç°å¹¶æµ‹è¯•é€šè¿‡
- âŒ **å‰ç«¯**: å®Œå…¨ä¸æ”¯æŒ

### å·®è·
- âŒ 0ä¸ªæŒ‡æ•°åˆ†æé¡µé¢ (éœ€è¦ 1ä¸ª)
- âŒ 0ä¸ªæŒ‡æ•°ç›¸å…³ç»„ä»¶ (éœ€è¦ 3-5ä¸ª)
- âŒ 0ä¸ªæŒ‡æ•°APIæ¥å£ (éœ€è¦ 2-3ä¸ª)
- âŒ 0æ¡æŒ‡æ•°è·¯ç”±é…ç½® (éœ€è¦ 1æ¡)
- âŒ 0ä¸ªèœå•å…¥å£ (éœ€è¦ 2ä¸ª)

### ä¼˜å…ˆçº§å»ºè®®
1. **ç«‹å³å¼€å‘** (P0): æ ¸å¿ƒåŠŸèƒ½ - IndexAnalysisé¡µé¢ã€APIæ¥å£ã€è·¯ç”±
2. **å°½å¿«å¼€å‘** (P1): ç”¨æˆ·ä½“éªŒ - IndexSelectorç»„ä»¶ã€èœå•å…¥å£
3. **åç»­è¿­ä»£** (P2): å¢å¼ºåŠŸèƒ½ - æŠ¥å‘Šå¯¹æ¯”ã€è¡Œæƒ…é›†æˆ

### èµ„æºéœ€æ±‚
- **å¼€å‘äººå‘˜**: 1åå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ
- **å¼€å‘å‘¨æœŸ**: 9-14ä¸ªå·¥ä½œæ—¥
- **æŠ€æœ¯æ ˆ**: Vue 3 + TypeScript + Element Plus
- **ä¾èµ–**: åç«¯æŒ‡æ•°åˆ†æAPI (å·²å®Œæˆ)

---

**æŠ¥å‘Šç»“è®º**: å‰ç«¯éœ€è¦å®Œæ•´å¼€å‘æŒ‡æ•°åˆ†æåŠŸèƒ½æ¨¡å—,é¢„è®¡éœ€è¦2å‘¨å·¦å³çš„å¼€å‘æ—¶é—´ã€‚å»ºè®®ä¼˜å…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½,ç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨è¯¥åŠŸèƒ½,åç»­å†é€æ­¥ä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’Œå¢å¼ºåŠŸèƒ½ã€‚

**ç¼–å†™äºº**: Qoder AI  
**å®¡æ ¸äºº**: å¾…å®š  
**æœ€åæ›´æ–°**: 2025-12-14
