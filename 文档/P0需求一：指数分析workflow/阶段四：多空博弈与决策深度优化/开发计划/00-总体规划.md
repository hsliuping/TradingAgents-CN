# 阶段四：多空博弈与决策深度优化 - 总体规划

## 1. 目标
通过引入多空辩论机制，提升指数分析决策的深度和可解释性，解决“决策过程黑盒”和“建议缺乏说服力”的问题。

## 2. 任务拆解

### 2.1 核心 Agent 开发
- [ ] **Task 1**: 实现 `Index Bull Researcher` (指数多头研究员)
    - 编写 Prompt，专注于针对目标指数从宏观/政策/技术面挖掘利好。
- [ ] **Task 2**: 实现 `Index Bear Researcher` (指数空头研究员)
    - 编写 Prompt，专注于针对目标指数挖掘风险点和反驳多头。

### 2.2 决策节点升级
- [ ] **Task 3**: 重构 `Strategy Advisor`
    - 接入辩论历史数据。
    - 修改输出 Schema，增加辩论总结字段。
    - 优化 Prompt 以利用辩论内容。

### 2.3 工作流集成
- [ ] **Task 4**: 修改 `setup.py`
    - 注册新节点。
    - 配置路由逻辑 (Conditional Edges)。
    - 调试图连接。

### 2.4 测试与验证
- [ ] **Task 5**: 全流程测试
    - 运行完整指数分析流程。
    - 检查日志中是否有 Bull/Bear 的发言。
    - 验证最终 JSON 报告中是否包含辩论总结。

## 3. 时间计划
- **Day 1**: 完成设计文档与 Agent 开发 (Task 1, 2)
- **Day 2**: 完成集成与测试 (Task 3, 4, 5)

## 4. 交付物
- 源代码：`index_bull_researcher.py`, `index_bear_researcher.py`, 更新后的 `strategy_advisor.py`, `setup.py`。
- 文档：更新后的设计文档、测试报告（包含生成的示例报告）。
