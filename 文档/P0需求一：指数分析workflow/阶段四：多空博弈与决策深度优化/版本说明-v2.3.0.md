# 版本说明 v2.3.0 - 指数分析多空博弈与决策深度优化

## 1. 版本概述
本次更新（v2.3.0）在指数分析工作流中引入了**多空博弈机制**，旨在解决原有决策过程“黑盒化”和“建议缺乏说服力”的问题。通过模拟多头与空头的辩论，系统现在能够提供包含定性深度分析和明确调仓逻辑的投资策略报告。

## 2. 新增特性

### 2.1 多空辩论层 (Debate Layer)
- **Index Bull Researcher (指数多头研究员)**: 
    - 专注于挖掘**目标指数**（如半导体、沪深300）的利好因素（宏观复苏、政策托底、技术支撑等）。
    - 针对空方观点进行反驳，主张增加仓位。
- **Index Bear Researcher (指数空头研究员)**: 
    - 专注于挖掘**目标指数**的潜在风险（估值泡沫、行业下行、外部冲击等）。
    - 针对多方观点进行批判，主张降低仓位或现金避险。

### 2.2 决策深度优化 (Decision Optimization)
- **Strategy Advisor (策略顾问)**:
    - **输入增强**: 接收多空双方的辩论历史 (`debate_history`)。
    - **逻辑增强**: 在生成决策时，必须综合考量辩论双方的论点，并在报告中体现裁决逻辑。
    - **输出增强**: JSON 报告新增 `debate_summary` 字段，总结核心分歧与胜负手。

### 2.3 工作流路由 (Workflow Routing)
- **新流程**: `... -> Technical Analyst -> Index Bull Researcher <-> Index Bear Researcher -> Strategy Advisor -> END`
- **循环机制**: 复用 `ConditionalLogic` 控制辩论轮次，确保充分讨论后进入决策环节。

## 3. 文件变更列表
- **新增**: `tradingagents/agents/researchers/index_bull_researcher.py`
- **新增**: `tradingagents/agents/researchers/index_bear_researcher.py`
- **修改**: `tradingagents/agents/analysts/strategy_advisor.py` (接入辩论数据)
- **修改**: `tradingagents/graph/setup.py` (注册节点与路由)
- **修改**: `文档/P0需求一：指数分析workflow/阶段四：...` (相关设计文档)

## 4. 下一步计划
- 观察多空辩论在极端行情下的表现（如单边暴跌时多头是否还能强行辩护）。
- 优化 Prompt 以减少“为了辩论而辩论”的废话，提高信息密度。
